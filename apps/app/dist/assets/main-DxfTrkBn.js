(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();let m,c,w,d,Le,f=null,y=null;const oe=[{name:"Low (640x480)",width:640,height:480},{name:"Medium (1280x720)",width:1280,height:720},{name:"High (1920x1080)",width:1920,height:1080},{name:"Ultra (2560x1440)",width:2560,height:1440}];let F=0;const lt="r1_camera_resolution";let T=0,h=[],Ie=!1,v=1,te=!1,Ze=0,et=1,U=!1,p=5,re=500,we=!1;const z={1:{delay:800,label:"Slow"},2:{delay:500,label:"Medium"},3:{delay:300,label:"Fast"}},ct="r1_camera_burst_settings",dt="r1_camera_last_preset";let V=!1,Y,Se,ne=null,C=0,M=!1,N=!1;const mt="r1_camera_gallery";let E=[],P=-1,x=1,ge=!1,tt=0,nt=1,I=1;const he=25;let ae=null,se=null,ut="newest",G="",pe="";const Nt=[{name:"IMPRESSIONISM",message:"Transform the image into a French Impressionist painting. Preserve subject identity. Use loose, visible brushstrokes, soft edges, and blended colors emphasizing natural light and atmosphere. Painterly oil-on-canvas texture with warm, luminous tones."},{name:"STEREOSCOPE",message:"Create a stereoscopic 3D side-by-side image from the photo. Maintain alignment and scale between left and right views. Subtle parallax for depth without distortion."},{name:"CYBERPUNK",message:"Transform the image into a cyberpunk scene. Neon lighting, futuristic city elements, holographic accents, and high-contrast color palette. Cinematic night lighting with tech-inspired details."},{name:"AI-BUY",message:"Analyze the image and identify purchasable items. Provide product names, estimated prices, and purchase links. Present results in a clean, structured list and email it to me."},{name:"AI-IDENTIFY",message:"Analyze the image in detail. Identify people, objects, environment, actions, expressions, and context. Provide a comprehensive, factual description without speculation and email it to me."},{name:"AI-SUMMARIZE",message:"Analyze the image and provide a comprehensive summary of what is depicted, including context, activity, and notable visual details and email it to me."},{name:"AI-TRANSLATE",message:"Detect any visible text in the image and translate it accurately into English. Preserve formatting where possible and email it to me."},{name:"LEGO",message:"Transform the image into a LEGO minifigure scene. Convert subjects into LEGO minifigures while preserving recognizable traits. Environment built entirely from LEGO bricks with toy-photography lighting."},{name:"CLAYMATION",message:"Transform the image into a claymation-style scene. Characters appear sculpted from clay with fingerprints and soft textures. Stop-motion animation aesthetic."},{name:"LINE DRAWING",message:"Convert the image into a hand-drawn line illustration. Black ink only, no color or shading. Clean white background with expressive line weight."},{name:"STREET ART",message:"Transform the image into contemporary street art. Gritty textures, stenciled patterns, expressive composition, and urban color palette on a concrete or brick surface."},{name:"CARICATURE",message:"Take a picture and make it a caricature. Defined by exaggerated features, bold expressions, and a humorous twist while preserving likeness. It captures the essence of a person or scene in a fun, over-the-top way, like something you would get from a street artist at a fair, bursting with personality and charm."},{name:"CHARCOAL",message:"Convert the image into a detailed charcoal sketch. Rich grayscale tones, textured shading, and expressive strokes on paper."},{name:"POP ART",message:"Take a picture and make it Pop Art. Employs vibrant, bold colors, simplified imagery, and techniques from the commercial world like screen-printing, often with a sense of humor, irony, or wit."},{name:"FEUDAL JAPAN",message:"Take a picture and place the subject in feudal Japan as a samurai. Preserve facial identity and physique. Authentic armor, period setting, cinematic lighting."},{name:"SHAKESPEAREAN",message:"Take a picture and make the subject an actor in a Shakespearean play. Dress the subject in period-accurate costume in the same style as the chosen Shakespearean play, apply stage lighting, and dramatic theatrical pose."},{name:"ASCII ART",message:"Take a picture and render it in ASCII format, where shapes and tones are created using punctuation and letters and using only keyboard characters to form the image. Built entirely from text characters, using letters, numbers, and symbols arranged in clever patterns. The image has a retro, digital feel, like something you would see on an old computer screen or printed in a vintage tech lab."},{name:"MEME",message:"Take a picture and make it into a MEME, adding ironic humor and flavor text inspired by the content of the image. Clean composition with readable typography."},{name:"SILHOUETTE",message:"Take a picture and convert the subject into a solid black silhouette. Subject interior filled with the background image. Outer background pure white."},{name:"JOHANNES VERMEER",message:"Take a picture a make it into a vibrant, painterly portrait into a Dutch Golden Age portrait inspired by Vermeer. Soft window lighting, rich detail, oil paint texture, calm atmosphere."},{name:"WALDO",message:"Take a picture in the style of a Where's Waldo-style illustration. The subject appears as Waldo with preserved traits, surrounded by many similar figures in a busy scene."},{name:"BOKEH PHOTOGRAPHY",message:"Take a picture in the style of Bokeh photography. Give it the aesthetic quality of the blur in the out-of-focus areas of a photograph with soft, circular light spots. Wide aperture and a fast lens, with the subject at a different focal plane from the background. Creates a shallow depth of field, blurring the background to make the subject stand out and adding a dreamy or artistic quality to the image."},{name:"REMBRANDT",message:"Take a picture in the style of Rembrandt van Rijn, Dutch Golden Age painting, oil painting, chiaroscuro masterpiece. Dramatic chiaroscuro lighting. Add atmospheric texture: rich oil painting texture, thick impasto brushstrokes, moody and spiritual atmosphere."},{name:"EXPRESSIONISM",message:"Take a picture in the Expressionism artistic movement emphasizing subjective emotions and inner experiences, often distorting reality to convey intense emotions and psychological states."},{name:"CELTIC ART",message:"Take a picture and convert it into a Celtic art piece inspired by the Book of Kells; highly detailed, intricate knotwork, flowing lines, and mystical geometry with the visual language of ancient Celtic art; ornate patterns and symbolic forms."},{name:"MYTHOLOGY",message:"Take a picture and make the subject into a Greek or Roman mythological creature while preserving recognizable characteristics of the subject. Epic, classical atmosphere."},{name:"RENAISSANCE",message:"Take a picture in the style of a Renaissance Painting. Include linear perspective, depth and realism. Focus on human expression, dynamic poses, and realistic landscapes. Feature a wide range of natural pigments like lead white, azurite, verdigris, ochers, malachite, vermilion, and lapis lazuli, used with binders such as egg tempera and oil, to create vibrant, naturalistic colors and complex effects. Focus on light, shadow, and harmonious blending to create realism and naturalism."},{name:"POINTILLISM",message:"Take a picture in the style of Pointillism Art. Complementary colors are placed next to each other to intensify each hue and create vibrancy as the viewer eye optically blends the dots from a distance. Made entirely of tiny, colorful dots."},{name:"SIMPSONS",message:"Take a picture in the style of a Simpsons cartoon scene, with yellow skin tones and Springfield vibes.  Complete with cartoon proportions and bright palettes. Preserve facial identity."},{name:"DISNEY",message:"Take a picture in the style of a hand-drawn Disney character portrait from the golden age of animation."},{name:"MUPPET",message:"Take a picture and make it a Muppet. Felt textures, button eyes, puppet proportions. Preserve subject personality."},{name:"PIXAR",message:"Take a picture in the style of Pixar signature 3D animation.  Use the Pixar style of blending realism with cartoon expressiveness. Vibrant colors, soft shadows, big eyes, rounded features, emotional depth, and animated charm."},{name:"BAROQUE",message:"Take a picture in the style of Spanish Baroque painting. Profound religious fervor, stark realism, and dramatic use of tenebrism to evoke strong emotions and piety."},{name:"ROCKWELL",message:"Take a picture in the style of a Norman Rockwell illustration. Render with meticulous detail and vibrant colors to portray realistic, yet idealized nostalgic Americana."},{name:"SKETCH ART",message:"Take a picture in the style of colorful Sketch Art. A rapidly executed, freehand drawing that serves as a preliminary step for a more detailed, finished work."},{name:"FELT PUPPET",message:"Take a picture and transform the image into a felt puppet scene. Soft fabric textures, handcrafted appearance."},{name:"INKBLOT",message:"Take a picture in the style of an inkblot-style artwork. Abstract symmetry, flowing ink forms on paper."},{name:"ANDY WARHOL",message:"Take a picture in the style of Andy Warhol. Pop Art with the use of four duplicated images in a frame."},{name:"CUBISM",message:"Take a picture in the style of Cubist Art. Break objects into geometric forms and reassemble them from multiple viewpoints simultaneously, challenging traditional perspective and depth to emphasize the two-dimensional canvas."},{name:"PEANUTS",message:"Take a picture in the style of a Peanuts cartoon strip. Have the subject speaking through a text bubble that reads GOOD GRIEF!"},{name:"COMIC",message:"Take a picture and make the subject a superhero in a comic book. Show a full comic-book page. Multiple panels showing action scenes with the subject. Bold inks, vibrant colors, onomatopoeia."},{name:"VAPORWAVE",message:"Take a picture and style it as if it were a retro-futuristic vaporwave album cover. Dreamy neon colors, glitchy textures, and retro-futuristic vibes. Inspired by 90s aesthetics and early internet culture, giving the photo a surreal, nostalgic feel, like a lost scene from an old VHS tape or a synthwave album cover."},{name:"MOVIE REEL",message:"Take a picture and make the scene into a movie reel with multiple frames. Move the subject slightly from one frame to the next to simulate movement."},{name:"POWERPUFF GIRLS",message:"Take a picture in the style of a Powerpuff girls animation."},{name:"A WHO",message:"Take a picture and make the subject into a Who from Whoville from Dr. Seuss. Make it photorealistic."},{name:"MINION",message:"Take a picture and make the subject into a Yellow Minion from the movie Despicable Me. Maintain the same facial features and characteristics as the subject. Add Minion goggles and Minion attire."},{name:"SOUTH PARK",message:"Take a picture in the style of a South Park cartoon scene with flat colors and exaggerated expressions.  Blocky limbs, simple shapes, and expressive faces."},{name:"RICK AND MORTY",message:"Take a picture in the style of a Rick and Morty episode scene - colorful, chaotic, and slightly grotesque. Convert characters from the Rick and Morty multiverse, complete with wacky gadgets, bizarre outfits, angular features, and offbeat personalities."},{name:"REAL-LUNGING",message:"Take a picture and make the inanimate object real and make it lunging at me. Make it photorealistic."},{name:"REAL-NOT LUNGING",message:"Take a picture and make the inanimate object real. Make it photorealistic."},{name:"BALLOON",message:"Take a picture in the style of a balloon animal or character.  Shiny latex texture."},{name:"MATRIX",message:"Take a picture in the style of the Matrix. Include Matrix Rain."},{name:"POSTCARD",message:'Take a picture in the style of a vintage postcard. Add text: "WISH YOU WERE HERE".'},{name:"PORTRAIT",message:"Take a picture in the style of Photorealistic Portrait. Frame the picture in a dark black wood frame."},{name:"ABSTRACT ART",message:"Take a picture in the style of Abstract Modern Art. Non-representational shapes, bold composition."},{name:"KEITH HARING",message:"Take a picture in the style of the American artist, Keith Haring. Bold black lines, energetic figures, flat colors."},{name:"SURREALISM",message:"Take a picture in the style of Surrealist art. Include dreamlike imagery, illogical juxtapositions, automatism, vivid dream imagery, symbolism, and a sense of absurdity."},{name:"SURREAL LANDSCAPE",message:"Take a picture and transform into a surreal landscape featuring a dreamlike quality pushing the boundaries of reality. Conjure a scene that has imaginative and otherworldly elements."},{name:"VICTORIAN PHOTO",message:"Take a picture in the style of a Vintage photo of a Victorian family. Sepia tones, period attire."},{name:"DYSTOPIAN",message:"Take a picture in the style of a Dystopian future. Bleak atmosphere. Make it photorealistic."},{name:"TABLOID",message:'Take a picture in the style of a Newspaper tabloid. The tabloid is the National Equirer. Headline: "SCANDAL!!!".'},{name:"POTTER",message:"Take a picture and place the subject naturally within a detailed, cinematic scene from the Harry Potter universe. Preserve facial identity. Surround the subject with authentic Hogwarts scenery - enchanted castle halls, floating candles, spell effects, and magical ambiance. Match the film's lighting and color grading for realism. Capture depth and atmosphere similar to the movies, with subtle magical motion or glow around wands and objects. Maintain the subject's natural facial features and proportions while blending clothing and environment into the Hogwarts world. Render in ultra-realistic 8K, with soft volumetric lighting, depth of field, and fantasy realism. Based on the subject's characteristics, the subject is wearing one of the four house robes (Gryffindor - Brave, daring, and chivalrous (colors: red & gold; mascot: lion), Slytherin - Ambitious, cunning, and resourceful (colors: green & silver; mascot: serpent), Ravenclaw - Wise, creative, and intellectual (colors: blue & bronze; mascot: eagle), Hufflepuff - Loyal, kind, and hardworking (colors: yellow & black; mascot: badger))."},{name:"SPACE",message:"Take a picture and place the subject in a space station wearing a space suit. The Earth is visible in the background. Make it photorealistic."},{name:"MOON",message:"Take a picture and place subject on the moon. Subject is wearing an astronaut suit. Subject face is visible through the helmet visor. The Earth is in the background. Make it photorealistic. Make it 8k resolution."},{name:"ALIENS",message:"Take a picture and place the subject in a scene from the movie Aliens. Dark sci-fi realism. Make it photorealistic."},{name:"STAR TREK",message:"Take a picture and place the subject on the bridge of the Starship Enterprise dressed in a Star Trek uniform. Make it photorealistic."},{name:"STAR WARS",message:"Take a picture and place the subject in a scene from the movie Start Wars.  Subject is dressed like a character in the movie. Make it photorealistic. Sci-fi realism."},{name:"POKEMON CARD",message:"Take a picture and make it into a pokemon card, add abilities and flavor text inspired by the content of the image. The result should be a full view of the card with a relevant background behind the card."},{name:"PROFILE",message:"Take a picture and turn the subject into an humorous FBI profile page.  Come up with a funny subject name and humorous crimes based on the image. Make it photorealistic."},{name:"FUNKO POP",message:"Take a picture and turn the subject into a Funko Pop. Oversized head, simplified body."},{name:"RAGDOLL",message:"Take a picture and turn the subject into a ragdoll. Maintain the characteristics of the subject. Fabric textures, stitched seams."},{name:"WESTERN",message:"Take a picture and have the setting be an Old West town.  Make it photorealistic cowboy setting."},{name:"UNDER THE SEA",message:"Take a picture and place the subject under the sea. The subject is wearing a bikini. Create an underwater seascape image capturing the beauty of the ocean depths. Include coral reefs, exotic fish, and aquatic plants, with sunlight filtering through the water to create dramatic lighting and a play of colors. Make it photorealistic."},{name:"HISTORY",message:"Take a picture and place the subject in a historical event that happened on todays calendar date. Make it photorealistic."},{name:"MYSTICAL",message:"Take a picture and transform it into a realistic, detailed mystical world, where trees have faces and bioluminescent plants and objects light up."},{name:"STANDING NEXT TO",message:"Take a picture and add a FAMOUS PERSON standing next to the subject. Match lighting and scale realistically."},{name:"VACATION",message:"Take a picture and have the subject standing in MAJOR METROPOLITAN CITY. The subject is wearing a Hawaiian shirt. Make it photorealistic. 8k resolution."},{name:"VINTAGE POSTER",message:"Take a picture in the style of a vintage movie poster. The poster uses lithography for printing on lightweight paper, and includes hand-painted illustrations. Add flavor text to the film title, director, and actor names inspired by the content of the image."},{name:"ROBOT",message:"Take a picture and make everything into mechanical robots that maintain the characteristics of the objects. Make it photorealistic."},{name:"BIBLICAL ILLUSTRATION",message:"Take a picture in the style of a Medieval Biblical illustration. Illuminated manuscript style."},{name:"YEARBOOK",message:"Take a picture and make the subject appear in an awkward, unflattering yearbook photo. Retro school photo style."},{name:"WANTED POSTER",message:'Take a picture in the style of an Old West Wanted Poster. Aged parchment, bullet holes. Title: "WANTED".'},{name:"TIME MAGAZINE",message:'Take a picture in the style of a polished TIME magazine cover. Title: "PERSON OF THE YEAR".'},{name:"STENCIL",message:"Take a picture in the style of Stencil Art. High contrast, limited color palette."},{name:"WATERCOLOR",message:"Take a picture in the style of a Watercolor painting. The pigments are mixed with water and applied to paper, creating luminous, transparent washes of color."},{name:"LOW POLY",message:"Take a picture using very low-poly modeling use minimal detail, faceted surfaces, and angular edges."},{name:"PAPERCRAFT",message:"Take a picture in the style of three-dimensional Papercraft. Folded paper textures and layered construction."},{name:"GRAFFITI",message:"Take a picture in the style of Graffiti Art. Spray paint textures, urban wall surface."},{name:"COLLAGE",message:"Take a picture in the style of an artistic paper collage with visible cut edges and layered materials."},{name:"MOSAIC",message:"Take a picture in the style of a glass Mosaic. Small tiles, reflective surfaces."},{name:"PORCELAIN",message:"Take a picture and make the subject a porcelain sculpture. Glossy ceramic finish."},{name:"LIGHT",message:"Take a picture and have everything made of light.  Varied colored lights with a glowing, ethereal, radiant effect."},{name:"CANDY",message:"Take a picture and make everything made out of candy. Glossy sweets, playful textures."},{name:"STATUE",message:"Take a picture and make subject into a bronze statue. Aged patina, sculptural realism."},{name:"ICE SCULPTURE",message:"Take a picture and make subject into an ice sculpture. The sculpture has the clarity and sparkle of ice, often enhanced by lighting, to showcase its form. Clear, chiseled ice with internal refraction."},{name:"MINECRAFT",message:"Take a picture in the style of Minecraft. Blocky geometry, pixel textures."},{name:"ROBLOX",message:"Take a picture in the style of Roblox. Simplified 3D characters."},{name:"GHIBLI CAM",message:"Take a picture in the Studio Ghibli anime style-soft colors, whimsical atmosphere, and hand-drawn aesthetic."},{name:"JAVERT PHOTOBOMB",message:"Take a picture and add in the background Russell Crowe as Javert from Les Miserable photobombing the subject. Match lighting realistically."},{name:"POTATO",message:"Take a picture and make the subject into a potato.  Preserve recognizable traits humorously."},{name:"R-ROLL",message:"Take a picture and include a singing Rick Astley standing next to the subject.  Make it photorealistic."},{name:"FAIRYTALE PAGE",message:"Take a picture and make it into a page from a magical children fairytale book. Like a page pulled from a magical tale, a whimsical world of castles, forests, and enchanted creatures. Soft textures, rich colors, and fairytale-like details giving the image a dreamy, otherworldly feel."},{name:"HIEROGLYPHICS",message:"Take a picture and make it hieroglyphic art. Everything is converted to pictures and symbols etched onto a stone monument or drawn onto papyrus."},{name:"BOMBOCLAAT",message:"Take a picture and make the subject look like a childlike black and white sketch drawn by a six year old."},{name:"MOUNT RUSHMORE",message:"Take a picture and make the subject face a carved head placed on Mount Rushmore. Make it photorealistic."},{name:"FILM NOIR",message:"Take a picture and transform the image into classic film noir style. High-contrast black and white. Hard directional lighting, deep shadows, Venetian blind light patterns. Moody, dramatic composition."},{name:"WES ANDERSON",message:"Take a picture and transform the image into a Wes Anderson-style scene. Perfect symmetry, centered composition. Pastel color palette, soft lighting. Whimsical, storybook tone."},{name:"BLADE RUNNER",message:"Take a picture and transform the image into a Blade Runner-inspired cinematic scene. Rain-soaked neon city, fog, reflections. High contrast, cyber-noir lighting. Photorealistic sci-fi atmosphere."},{name:"VHS 80s",message:"Take a picture and transform the image into 1980s VHS footage. Soft focus, scanlines, color bleed, timestamp artifacts. Analog nostalgia aesthetic."},{name:"LONG EXPOSURE",message:"Take a picture and apply long-exposure photography style. Light trails, motion blur on moving elements. Static subject remains sharp."},{name:"TILT-SHIFT",message:"Take a picture and Apply tilt-shift photography effect. Selective focus creating a miniature diorama look. Blurred foreground and background."},{name:"MACRO",message:"Take a picture and transform the image into macro photography. Extreme close-up detail. Shallow depth of field, high texture clarity."},{name:"INFRARED",message:"Take a picture and transform the image into infrared photography. Bright foliage, dark skies. Surreal tonal contrast."},{name:"WOODCUT",message:"Take a picture and transform the image into a traditional woodcut print. Bold carved lines, high contrast. Limited color palette."},{name:"LINOLEUM PRINT",message:"Take a picture and transform the image into a linoleum block print. Organic carved textures. Flat ink colors."},{name:"RISOGRAPH",message:"Take a picture and transform the image into risograph print style. Layered ink colors, misregistration. Paper grain texture."},{name:"BLUEPRINT",message:"Take a picture and transform the image into a blueprint technical drawing. White linework on blue background. Precise, schematic style."},{name:"DREAM LOGIC",message:"Take a picture and transform the image using dream logic. Disjointed scale, symbolic elements. Unreal but emotionally coherent."},{name:"TIME DILATION",message:"Take a picture and depict the image as if time is slowed or fractured. Motion echoes, temporal distortions."},{name:"GLASS",message:"Take a picture and transform everything into transparent glass. Refraction, reflections, caustic lighting."},{name:"RUBBER HOSE",message:"Take a picture and transform the image into 1930s rubber hose animation style. Bouncy limbs, simple faces. Vintage cartoon aesthetic."},{name:"PLUSH TOY",message:"Take a picture and transform the subject into a plush toy. Soft fabric, stitching details. Cute proportions."},{name:"NEWSPAPER",message:"Take a picture and Transform the image into a newspaper print. Halftone dots, grayscale ink. Newsprint texture."},{name:"ISOMETRIC",message:"Take a picture and transform the scene into isometric perspective. Clean geometry, consistent angles. Game-like layout."},{name:"RPG PORTRAIT",message:"Take a picture and transform the subject into an RPG character portrait. Fantasy UI frame, stat panel styling. Painted character art."},{name:"X-RAY",message:"Take a picture and transform the image into an X-ray view. Semi-transparent layers revealing internal structure. Monochrome glow."},{name:"THERMAL",message:"Take a picture and transform the image into thermal imaging. False-color heat mapping. High contrast."},{name:"NIGHT VISION",message:"Take a picture and transform the image into night vision style. Green monochrome, sensor noise."},{name:"GLITCH REALITY",message:"Take a picture and introduce digital glitches into a realistic scene. Pixel tearing, compression artifacts. Reality appears corrupted."},{name:"FRACTAL",message:"Take a picture and transform the image using fractal geometry. Recursive patterns, infinite detail."},{name:"ESCHER",message:"Take a picture and transform the image into an M.C. Escher-inspired impossible space. Non-Euclidean architecture."},{name:"ALTER EGO",message:"Take a picture and transform the image to reveal an alternate version of the subject. Same facial identity, different personality and visual style."},{name:"FUTURE SELF",message:"Take a picture and depict the subject 20-40 years in the future. Preserve facial structure with realistic aging."},{name:"MULTIVERSE",message:"Take a picture and create parallel versions of the same subject in different realities. Each version subtly different in style, clothing, or environment."},{name:"STORY MOMENT",message:"Take a picture and transform the image into a single dramatic story moment. Imply what happened before and what will happen next through visual clues. Cinematic composition."},{name:"TINY WORLD",message:"Take a picture and transform the scene so the subject appears miniature. Environment becomes massive. Tilt-shift realism."},{name:"RECURSIVE IMAGE",message:"Take a picture and transform the image into infinite visual recursion. The image contains itself within itself."},{name:"GIANT WORLD",message:"Take a picture and transform the subject into a giant towering over the environment. Realistic scale interaction."},{name:"HIDDEN DETAILS",message:"Take a picture and transform the image so subtle hidden elements are embedded. Viewer should discover details only after close inspection."},{name:"CHILDHOOD VERSION",message:"Take a picture and depict the subject as a child while preserving recognizable traits. Soft lighting, nostalgic tone."},{name:"PICTURE PERFECT",message:"Take a picture and make it picture perfect - improve lighting, colors, and overall composition. Professional perfection. Correct lighting, color, sharpness, and realism. Remove any imperfections.  Make it photorealistic.  8k resolution."}];let l=[...Nt],g=0,_=-1,B=navigator.onLine,u=[],q=!1,O=null,fe=0;const gt=500,ht="r1_camera_queue";let j,W,L;const pt="r1_camera_styles";let R=[];const ft="r1_camera_favorites";function Pe(e){ne&&(clearTimeout(ne),ne=null),Y||(Y=document.getElementById("style-reveal"),Se=document.getElementById("style-reveal-text")),!(!Y||!Se)&&(Se.textContent=e,Y.style.display="block",ne=setTimeout(()=>{Y&&(Y.style.display="none"),ne=null},1200))}function Dt(){try{const e=localStorage.getItem(mt);e&&(E=JSON.parse(e))}catch(e){console.error("Error loading gallery:",e),E=[]}}function yt(){try{localStorage.setItem(mt,JSON.stringify(E))}catch(e){console.error("Error saving gallery:",e)}}function Et(e){const t={id:Date.now().toString()+"-"+Math.random().toString(36).substr(2,9),imageBase64:e,timestamp:Date.now()};E.unshift(t),E.length>100&&(E=E.slice(0,100)),yt()}function Ht(e){return!ae&&!se?e:e.filter(t=>{const n=new Date(t.timestamp);n.setHours(0,0,0,0);const a=n.getTime();let s=!0,i=!0;if(ae){const o=new Date(ae).getTime();s=a>=o}if(se){const o=new Date(se).getTime();i=a<=o}return s&&i})}function jt(e){const t=[...e];return ut==="newest"?t.sort((n,a)=>a.timestamp-n.timestamp):t.sort((n,a)=>n.timestamp-a.timestamp),t}function vt(){let e=Ht(E);return jt(e)}function K(){const e=document.getElementById("gallery-modal"),t=document.getElementById("gallery-grid"),n=document.getElementById("gallery-pagination"),a=document.getElementById("page-info"),s=document.getElementById("prev-page"),i=document.getElementById("next-page"),o=vt();if(o.length===0)t.innerHTML='<div class="gallery-empty">No photos match the selected filter.</div>',n.style.display="none";else{const r=Math.ceil(o.length/he);I=Math.min(I,r);const b=(I-1)*he,A=Math.min(b+he,o.length),de=o.slice(b,A),Z=document.createDocumentFragment();de.forEach($=>{const D=document.createElement("div");D.className="gallery-item";const H=document.createElement("img");H.src=$.imageBase64,H.alt="Gallery image",H.loading="lazy",D.appendChild(H),D.onclick=()=>{const me=E.findIndex(ue=>ue.id===$.id);Ft(me)},Z.appendChild(D)}),t.innerHTML="",t.appendChild(Z),r>1?(n.style.display="flex",a.textContent=`Page ${I} of ${r}`,s.disabled=I===1,i.disabled=I===r):n.style.display="none"}e.style.display="flex"}function bt(){document.getElementById("gallery-modal").style.display="none",I=1}function Gt(){const e=vt(),t=Math.ceil(e.length/he);I<t&&(I++,K())}function Ut(){I>1&&(I--,K())}function Be(){I=1,K()}function at(e,t){const n=e==="start"?"gallery-start-date-btn":"gallery-end-date-btn",a=document.getElementById(n);if(!a)return;const s=a.querySelector(".date-button-text");if(s)if(t){const o=new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});s.textContent=o,a.classList.add("has-date")}else s.textContent=e==="start"?"Start":"End",a.classList.remove("has-date")}function Ft(e){if(e<0||e>=E.length)return;P=e;const t=E[e],n=document.getElementById("image-viewer"),a=document.getElementById("viewer-image"),s=document.getElementById("viewer-prompt");a.src=t.imageBase64,a.style.transform="scale(1) translate(0, 0)",x=1,s.value="",n.style.display="flex",bt()}function qt(){document.getElementById("image-viewer").style.display="none",P=-1,x=1,K()}function _t(){P<0||P>=E.length||confirm("Delete this image from gallery?")&&(E.splice(P,1),yt(),document.getElementById("image-viewer").style.display="none",P=-1,x=1,K())}function $t(){const e=document.getElementById("preset-selector");Tt(),e.style.display="flex"}function kt(){document.getElementById("preset-selector").style.display="none",pe="",document.getElementById("preset-filter").value=""}function Tt(){const e=document.getElementById("preset-list");e.innerHTML="";const t=l.filter(n=>{if(!pe)return!0;const a=pe.toLowerCase();return n.name.toLowerCase().includes(a)||n.message.toLowerCase().includes(a)});if(t.length===0){e.innerHTML='<div class="preset-empty">No presets found</div>';return}t.forEach(n=>{const a=document.createElement("div");a.className="preset-item";const s=document.createElement("div");s.className="preset-name",s.textContent=n.name;const i=document.createElement("div");i.className="preset-description",i.textContent=n.message.substring(0,60)+"...",a.appendChild(s),a.appendChild(i),a.onclick=()=>{Yt(n)},e.appendChild(a)})}function Yt(e){const t=document.getElementById("viewer-prompt");t.value=e.message,kt()}function Vt(){if(P<0||P>=E.length){alert("No image selected");return}const t=document.getElementById("viewer-prompt").value.trim();if(!t){alert("Please enter a prompt or load a preset");return}const n=E[P];typeof PluginMessageHandler<"u"?(PluginMessageHandler.postMessage(JSON.stringify({message:t,pluginId:"com.r1.pixelart",imageBase64:n.imageBase64})),alert("Magic transform submitted! You can submit again with a different prompt.")):alert("Magic transform sent: "+t.substring(0,50)+"...")}function Wt(){const e=document.getElementById("viewer-image"),t=document.querySelector(".image-viewer-container");let n=0,a=0,s=0,i=0,o=!1;t.addEventListener("touchstart",r=>{r.touches.length===2?(r.preventDefault(),ge=!0,tt=st(r.touches[0],r.touches[1]),nt=x):r.touches.length===1&&x>1&&(o=!0,s=r.touches[0].clientX-n,i=r.touches[0].clientY-a)},{passive:!1}),t.addEventListener("touchmove",r=>{if(ge&&r.touches.length===2){r.preventDefault();const A=st(r.touches[0],r.touches[1])/tt;x=Math.max(1,Math.min(nt*A,5)),e.style.transform=`scale(${x}) translate(${n}px, ${a}px)`}else o&&r.touches.length===1&&x>1&&(r.preventDefault(),n=r.touches[0].clientX-s,a=r.touches[0].clientY-i,e.style.transform=`scale(${x}) translate(${n}px, ${a}px)`)},{passive:!1}),t.addEventListener("touchend",r=>{r.touches.length<2&&(ge=!1),r.touches.length===0&&(o=!1,x===1&&(n=0,a=0,e.style.transform="scale(1) translate(0, 0)"))}),t.addEventListener("touchcancel",()=>{ge=!1,o=!1})}function st(e,t){const n=e.clientX-t.clientX,a=e.clientY-t.clientY;return Math.sqrt(n*n+a*a)}function ve(){if(!M)return;const e=document.getElementById("menu-styles-list");if(!e)return;const t=e.querySelectorAll(".style-item");if(t.length===0)return;t.forEach(a=>{a.classList.remove("menu-selected")}),C=Math.max(0,Math.min(C,t.length-1));const n=t[C];n&&(n.classList.add("menu-selected"),n.scrollIntoView({behavior:"smooth",block:"nearest"}))}function zt(){if(!M||!N)return;const e=document.getElementById("menu-styles-list");if(!e)return;const t=e.querySelectorAll(".style-item");t.length!==0&&(C=(C-1+t.length)%t.length,ve())}function Jt(){if(!M||!N)return;const e=document.getElementById("menu-styles-list");if(!e)return;const t=e.querySelectorAll(".style-item");t.length!==0&&(C=(C+1)%t.length,ve())}function Kt(){if(!M||!N)return;const e=document.getElementById("menu-styles-list");if(!e)return;const t=e.querySelectorAll(".style-item");if(t.length===0||C>=t.length)return;const n=t[C];if(n&&n.querySelector(".style-name")){const i=le()[C];if(i){const o=l.findIndex(r=>r===i);o!==-1&&(g=o,S(),Oe())}}}function Xt(){const e=localStorage.getItem(pt);if(e)try{const n=JSON.parse(e);l=l.filter(a=>a.internal),l.push(...n)}catch(n){console.error("Error loading styles:",n)}const t=localStorage.getItem(ft);if(t)try{R=JSON.parse(t),Array.isArray(R)||(R=[])}catch(n){console.error("Error parsing favorite styles:",n),R=[]}tn(),Zt()}function Qt(e){try{localStorage.setItem(lt,e.toString())}catch(t){console.error("Error saving resolution:",t)}}function Zt(){try{const e=localStorage.getItem(lt);if(e!==null){const t=parseInt(e,10);t>=0&&t<oe.length&&(F=t)}}catch(e){console.error("Error loading resolution:",e)}}function It(){const t=l.filter(s=>!s.internal).slice().sort((s,i)=>s.name.localeCompare(i.name)),n=t.filter(s=>ye(s.name)),a=t.filter(s=>!ye(s.name));return{favorites:n,regular:a}}function le(){return It().regular}function wt(){const e=le(),t=l[g];return e.findIndex(n=>n===t)}function St(e){const n=le()[e];return l.findIndex(a=>a===n)}function Bt(){try{localStorage.setItem(pt,JSON.stringify(l))}catch(e){console.error("Error saving styles:",e)}}function it(e){const t=l.findIndex(o=>o===e),n=document.createElement("div");n.className="style-item",t===g&&n.classList.add("active");const a=document.createElement("span");a.className="style-name",a.textContent=e.name;const s=document.createElement("button");s.className="style-favorite",s.textContent=ye(e.name)?"⭐":"☆",s.onclick=o=>{o.stopPropagation(),en(e.name)};const i=document.createElement("button");return i.className="style-edit",i.textContent="Edit",i.onclick=o=>{o.stopPropagation(),Sn(t)},n.appendChild(a),n.appendChild(s),n.appendChild(i),n.onclick=()=>{g=t,S(),Oe()},n}function en(e){const t=R.indexOf(e);t>-1?R.splice(t,1):R.push(e),localStorage.setItem(ft,JSON.stringify(R)),Q()}function tn(){const e=localStorage.getItem(dt);if(e!==null)try{const t=parseInt(e,10);t>=0&&t<l.length&&(g=t)}catch(t){console.error("Error loading last used style:",t)}}function ye(e){return R.includes(e)}function Ct(){const e=l.filter(a=>!a.internal&&ye(a.name));if(e.length>0){const a=e[Math.floor(Math.random()*e.length)];return l.findIndex(s=>s===a)}const t=l.filter(a=>!a.internal);if(t.length===0)return 0;const n=t[Math.floor(Math.random()*t.length)];return l.findIndex(a=>a===n)}function nn(){V=!V;const e=document.getElementById("random-toggle");V?(e.classList.add("random-active"),d.textContent=`Random mode ON • ${l[g].name}`):(e.classList.remove("random-active"),S()),typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({action:"random_mode_toggled",enabled:V,timestamp:Date.now()}))}function an(){try{const e=localStorage.getItem(ht);e&&(u=JSON.parse(e))}catch(e){console.error("Error loading queue:",e),u=[]}}function ce(){try{localStorage.setItem(ht,JSON.stringify(u))}catch(e){console.error("Error saving queue:",e)}}function Ce(){j&&(B?(j.className="connection-status online",j.querySelector("#connection-text").textContent="Online"):(j.className="connection-status offline",j.querySelector("#connection-text").textContent="Offline"),j.style.display="block"),X()}function X(){if(W){const e=u.length;W.querySelector("#queue-count").textContent=e,W.style.display=e>0?"block":"none"}if(L){const e=u.length;L.querySelector("#sync-count").textContent=e,L.style.display=e>0&&B?"block":"none"}}function sn(){window.addEventListener("online",()=>{B=!0,Ce(),console.log("Connection restored"),u.length>0&&!q&&setTimeout(()=>{d.textContent=`Connection restored! Syncing ${u.length} photos...`,ie()},1e3)}),window.addEventListener("offline",()=>{B=!1,Ce(),console.log("Connection lost"),q&&(d.textContent="Connection lost during sync")}),Ce()}async function on(){try{return h=(await navigator.mediaDevices.enumerateDevices()).filter(t=>t.kind==="videoinput"),console.log("Available cameras:",h.length),h}catch(e){return console.error("Error enumerating cameras:",e),[]}}function Re(){const e=oe[F];if(h.length===0)return{video:{facingMode:"environment",width:{ideal:e.width},height:{ideal:e.height}}};const n={video:{deviceId:{exact:h[T].deviceId},width:{ideal:e.width},height:{ideal:e.height}}};return J()&&(n.video.advanced=[{zoom:1}]),n}async function rn(e){if(!(e===F||!f)){F=e,Qt(e);try{d.textContent="Changing resolution...",f&&f.getTracks().forEach(n=>n.stop());const t=Re();f=await navigator.mediaDevices.getUserMedia(t),m.srcObject=f,y=f.getVideoTracks()[0],await new Promise(n=>{m.onloadedmetadata=async()=>{try{await m.play(),Ee(),await be(v),setTimeout(n,100)}catch(a){console.error("Video play error:",a),n()}}}),S(),typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({action:"resolution_changed",resolution:oe[F].name,timestamp:Date.now()}))}catch(t){console.error("Resolution change error:",t),d.textContent="Resolution change failed"}}}function Me(){if(h.length===0)return"Default Camera";const e=h[T];let t=e.label;return!t||t===""?e.deviceId?t=`Camera ${T+1}`:t="Unknown Camera":(t=t.replace(/\([^)]*\)/g,"").trim(),t.toLowerCase().includes("front")?t="Front Camera":t.toLowerCase().includes("back")||t.toLowerCase().includes("rear")?t="Back Camera":t.length>20&&(t=t.substring(0,17)+"...")),t}function J(){if(h.length<=1)return!0;const e=h[T],t=e.label.toLowerCase();return e.facingMode==="user"?!0:t.includes("front")||t.includes("user")||t.includes("selfie")||t.includes("face")}function Ee(){var e;try{const t=h[T],n=((e=t==null?void 0:t.label)==null?void 0:e.toLowerCase())||"",a=J(),s=navigator.userAgent.toLowerCase().includes("r1")||n.includes("r1");a&&!s?(m.style.transform="scaleX(-1) translateZ(0)",m.style.webkitTransform="scaleX(-1) translateZ(0)"):(m.style.transform="translateZ(0)",m.style.webkitTransform="translateZ(0)")}catch(t){console.warn("Mirror transform skipped:",t)}}function ln(){if(!y)return!1;const e=y.getCapabilities();return e&&"zoom"in e}function Mt(){if(!y)return{min:1,max:5,step:.1};const e=y.getCapabilities();return e&&e.zoom?{min:Math.min(e.zoom.min||1,1),max:Math.max(e.zoom.max||5,5),step:e.zoom.step||.1}:{min:1,max:5,step:.1}}async function be(e){if(y)try{if(ln()){const t=Mt(),n=Math.max(t.min,Math.min(e,t.max)),a={advanced:[{zoom:n}]},s=y.getCapabilities();s&&s.focusMode&&s.focusMode.includes("continuous")&&(a.advanced[0].focusMode="continuous"),await y.applyConstraints(a),v=n,console.log("Applied hardware zoom:",n)}else{const t=Math.max(1,Math.min(e,5));v=t,J()?m.style.transform=`scaleX(-1) scale(${t})`:m.style.transform=`scale(${t})`,console.log("Applied CSS zoom:",t)}}catch(t){console.error("Error applying zoom:",t);const n=Math.max(1,Math.min(e,5));v=n,J()?m.style.transform=`scaleX(-1) scale(${n})`:m.style.transform=`scale(${n})`}}async function xt(){if(y)try{const e=y.getCapabilities();e&&e.focusMode&&(e.focusMode.includes("single-shot")?(await y.applyConstraints({advanced:[{focusMode:"single-shot",zoom:v}]}),console.log("Triggered single-shot focus"),setTimeout(async()=>{try{await y.applyConstraints({advanced:[{focusMode:"continuous",zoom:v}]})}catch(t){console.log("Could not return to continuous focus:",t)}},500)):e.focusMode.includes("manual")&&(await y.applyConstraints({advanced:[{focusMode:"manual",zoom:v}]}),console.log("Triggered manual focus")))}catch(e){console.log("Focus adjustment not supported or failed:",e)}}async function cn(){if(Ie||h.length<=1){console.log("Cannot switch camera: loading or not enough cameras");return}Ie=!0;try{d.textContent="Switching camera...",f&&f.getTracks().forEach(t=>t.stop()),T=(T+1)%h.length,console.log(`Switching to camera ${T+1} of ${h.length}`);const e=Re();f=await navigator.mediaDevices.getUserMedia(e),m.srcObject=f,y=f.getVideoTracks()[0],await new Promise(t=>{m.onloadedmetadata=async()=>{try{await m.play(),Ee(),await be(v),setTimeout(t,100)}catch(n){console.error("Video play error:",n),t()}}}),S(),typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({action:"camera_switched",cameraIndex:T,cameraLabel:Me(),timestamp:Date.now()}))}catch(e){console.error("Camera switch error:",e),d.textContent="Camera switch failed",T=(T-1+h.length)%h.length}finally{Ie=!1}}function dn(){try{const e=localStorage.getItem(ct);if(e){const t=JSON.parse(e);p=t.count||5;const n=t.speed||2;re=z[n].delay}}catch(e){console.error("Error loading burst settings:",e)}}function ot(e,t){try{localStorage.setItem(ct,JSON.stringify({count:e,speed:t}))}catch(n){console.error("Error saving burst settings:",n)}}function mn(){U=!U;const e=document.getElementById("burst-toggle");U?(e.classList.add("burst-active"),d.textContent=`Burst mode ON (${p} photos) • ${l[g].name}`):(e.classList.remove("burst-active"),S()),typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({action:"burst_mode_toggled",enabled:U,count:p,timestamp:Date.now()}))}async function un(){if(!(!f||we||w.style.display==="block")){we=!0,d.textContent=`Burst mode: Taking ${p} photos...`;for(let e=0;e<p;e++)d.textContent=`Burst ${e+1}/${p}...`,gn(e+1),e<p-1&&await new Promise(t=>setTimeout(t,re));we=!1,d.textContent=`Burst complete! ${p} photos saved.`,B&&!q?setTimeout(()=>{ie()},500):B||(d.textContent=`Burst complete! ${p} photos queued (offline).`),typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({action:"burst_complete",count:p,timestamp:Date.now()})),setTimeout(()=>{U?d.textContent=`Burst mode ON (${p} photos) • ${l[g].name}`:S()},2e3)}}function gn(e){if(!f)return;V&&(g=Ct()),c.width=m.videoWidth,c.height=m.videoHeight;const t=c.getContext("2d");t.clearRect(0,0,c.width,c.height);const n=c.width/v,a=c.height/v,s=(c.width-n)/2,i=(c.height-a)/2;J()?(t.save(),t.scale(-1,1),t.drawImage(m,s,i,n,a,-c.width,0,c.width,c.height),t.restore()):t.drawImage(m,s,i,n,a,0,0,c.width,c.height);const o=c.toDataURL("image/jpeg",.8),r=l[g];Et(o);const b={id:Date.now().toString()+"-"+e,imageBase64:o,preset:r,timestamp:Date.now()};u.push(b),ce(),X()}async function hn(){try{if(m=document.getElementById("video"),c=document.getElementById("canvas"),w=document.getElementById("captured-image"),d=document.getElementById("status"),Le=document.getElementById("reset-button"),document.getElementById("start-screen").querySelector(".start-text").textContent="Loading camera...",document.getElementById("start-button").disabled=!0,await on(),h.length>1){const o=h.findIndex(r=>{const b=r.label.toLowerCase();return b.includes("back")||b.includes("rear")||b.includes("environment")});T=o!==-1?o:h.length-1}else T=0;const e=Re();f=await navigator.mediaDevices.getUserMedia(e),m.srcObject=f,y=f.getVideoTracks()[0],console.log("Camera initialized:",Me()),an(),sn(),await new Promise(o=>{m.onloadedmetadata=async()=>{try{await m.play(),Ee(),m.addEventListener("playing",Ee),setTimeout(o,100)}catch(r){console.error("Video play error:",r),o()}}}),document.getElementById("start-screen").style.display="none",document.getElementById("camera-container").style.display="flex",d.style.display="block";const t=document.getElementById("camera-button");h.length>1&&(t.style.display="flex");const n=document.getElementById("menu-button");n&&(n.style.display="flex");const a=document.getElementById("burst-toggle");a&&(a.style.display="flex");const s=document.getElementById("random-toggle");s&&(s.style.display="flex");const i=document.getElementById("gallery-button");i&&(i.style.display="flex"),S(),typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({status:"camera_ready",availableCameras:h.length,currentCamera:Me(),timestamp:Date.now()}))}catch(e){console.error("Camera access error:",e),d.textContent="Camera access denied",typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({status:"camera_error",error:e.message,timestamp:Date.now()}))}}function pn(){if(!f)return;V&&(g=Ct(),Pe(l[g].name)),c.width=m.videoWidth,c.height=m.videoHeight;const e=c.getContext("2d");e.clearRect(0,0,c.width,c.height);const t=c.width/v,n=c.height/v,a=(c.width-t)/2,s=(c.height-n)/2;J()?(e.save(),e.scale(-1,1),e.drawImage(m,a,s,t,n,-c.width,0,c.width,c.height),e.restore()):e.drawImage(m,a,s,t,n,0,0,c.width,c.height);const i=c.toDataURL("image/jpeg",.8);w.src=i,w.style.display="block",w.style.transform="none",m.style.display="none",Le.style.display="block";const o=document.getElementById("camera-button");o&&(o.style.display="none");const r=document.getElementById("resolution-button");r&&(r.style.display="none"),Et(i);const b=l[g],A={id:Date.now().toString(),imageBase64:i,preset:b,timestamp:Date.now()};u.push(A),ce(),X(),B?(d.textContent="Photo saved! Uploading...",q||ie()):d.textContent=`Photo queued for sync (${u.length} in queue)`,typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({action:"photo_captured",queued:!0,queueLength:u.length,timestamp:Date.now()}))}async function ie(){if(u.length===0||q)return;if(!B){d.textContent="Cannot sync - offline";return}q=!0,L.disabled=!0,L.classList.add("syncing"),console.log(`Syncing ${u.length} queued photos...`);const e=u.length;let t=0;for(;u.length>0&&B;){const n=u[0];try{if(d.textContent=`Syncing ${t+1}/${e}...`,typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({message:n.preset.message,pluginId:"com.r1.pixelart",imageBase64:n.imageBase64})),await new Promise(a=>setTimeout(a,500)),B)u.shift(),t++,ce(),X();else{console.log("Lost connection during sync");break}await new Promise(a=>setTimeout(a,1e3))}catch(a){console.error("Sync error:",a),d.textContent="Sync error - will retry later";break}}q=!1,L.disabled=!1,L.classList.remove("syncing"),u.length===0?(d.textContent=`All ${t} photos synced successfully!`,setTimeout(()=>{S()},2e3)):B?d.textContent=`Synced ${t}. ${u.length} remaining.`:d.textContent=`Connection lost. ${u.length} photos queued.`,typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({action:"sync_complete",synced:t,remaining:u.length,timestamp:Date.now()}))}function Ae(){const e=document.getElementById("queue-manager"),t=document.getElementById("queue-list");t.innerHTML="",u.length===0?t.innerHTML=`
      <div class="queue-empty">
        <h4>No Photos in Queue</h4>
        <p>Take photos while offline and they'll appear here for syncing.</p>
      </div>
    `:u.forEach((n,a)=>{const s=document.createElement("div");s.className="queue-item",s.innerHTML=`
        <div class="queue-item-header">
          <span class="queue-item-style">${n.preset.name}</span>
          <span class="queue-item-time">${new Date(n.timestamp).toLocaleString()}</span>
        </div>
        <img src="${n.imageBase64}" class="queue-item-preview" alt="Queued photo">
        <div class="queue-item-actions">
          <button onclick="removeFromQueue(${a})" class="delete-button">Remove</button>
          <button onclick="previewQueueItem(${a})" class="secondary">Preview</button>
        </div>
      `,t.appendChild(s)}),e.style.display="flex"}function fn(){document.getElementById("queue-manager").style.display="none"}function yn(e){confirm("Remove this photo from the sync queue?")&&(u.splice(e,1),ce(),X(),Ae())}function En(e){const t=u[e];alert(`Style: ${t.preset.name}
Prompt: ${t.preset.message}
Saved: ${new Date(t.timestamp).toLocaleString()}`)}function Lt(){confirm("Clear all photos from the queue? This cannot be undone.")&&(u=[],ce(),X(),Ae())}window.addEventListener("sideClick",()=>{if(console.log("Side button pressed"),M&&N){Kt();return}const e=document.getElementById("start-screen"),t=document.getElementById("start-button");e&&e.style.display!=="none"?(console.log("Simulating tap on start button"),setTimeout(()=>{t.click()},100)):w&&w.style.display==="block"?Pt():U?un():pn()});window.addEventListener("scrollUp",()=>{if(console.log("Scroll wheel: up"),M&&N){zt();return}if(!f||w.style.display==="block")return;const e=Date.now();e-fe<gt||(fe=e,O&&clearTimeout(O),O=setTimeout(()=>{let t=wt();const n=le();t=(t-1+n.length)%n.length,g=St(t);const a=l[g];a&&Pe(a.name),S(),typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({action:"preset_changed",preset:l[g].name,timestamp:Date.now()})),O=null},50))});window.addEventListener("scrollDown",()=>{if(console.log("Scroll wheel: down"),M&&N){Jt();return}if(!f||w.style.display==="block")return;const e=Date.now();e-fe<gt||(fe=e,O&&clearTimeout(O),O=setTimeout(()=>{let t=wt();const n=le();t=(t+1)%n.length,g=St(t);const a=l[g];a&&Pe(a.name),S(),typeof PluginMessageHandler<"u"&&PluginMessageHandler.postMessage(JSON.stringify({action:"preset_changed",preset:l[g].name,timestamp:Date.now()})),O=null},50))});function S(){g=Math.max(0,Math.min(g,l.length-1));const e=l[g];if(y)try{const t={};y.applyConstraints(t)}catch(t){console.error("Error applying preset constraints:",t)}d&&(d.textContent=`Style: ${e.name}`),localStorage.setItem(dt,g.toString()),M&&ve()}window.onPluginMessage=function(e){console.log("Received plugin message:",e),e&&e.status==="processing"?d.textContent="AI is processing your image...":e&&e.status==="complete"?d.textContent="AI transformation complete!":e&&e.error&&(d.textContent="Error: "+e.error)};typeof PluginMessageHandler<"u"?(console.log("Flutter channel is available"),PluginMessageHandler.postMessage(JSON.stringify({message:"AI Camera Styles initialized",pluginId:"com.r1.pixelart"}))):console.log("Running in development mode - Flutter channel not available");function Pt(){w.style.display="none",w.style.transform="none",m.style.display="block",Le.style.display="none";const e=document.getElementById("camera-button");e&&h.length>1&&(e.style.display="flex");const t=document.getElementById("resolution-button");t&&(t.style.display="flex"),setTimeout(()=>{be(v)},50),S()}function rt(e,t){const n=e.clientX-t.clientX,a=e.clientY-t.clientY;return Math.sqrt(n*n+a*a)}function vn(){const e=document.getElementById("video");e.addEventListener("touchstart",t=>{t.touches.length===2&&(t.preventDefault(),te=!0,Ze=rt(t.touches[0],t.touches[1]),et=v)},{passive:!1}),e.addEventListener("touchmove",t=>{if(te&&t.touches.length===2){t.preventDefault();const a=rt(t.touches[0],t.touches[1])/Ze,s=et*a,i=Mt(),o=Math.max(i.min,Math.min(s,i.max));be(o)}},{passive:!1}),e.addEventListener("touchend",t=>{t.touches.length<2&&(te&&xt(),te=!1,console.log("Pinch ended, current zoom:",v))}),e.addEventListener("touchcancel",()=>{te=!1})}function bn(){const e=document.getElementById("video");e.addEventListener("click",t=>{if(!M&&w.style.display==="none"){xt();const n=e.getBoundingClientRect(),a=t.clientX-n.left,s=t.clientY-n.top,i=document.createElement("div");i.style.position="absolute",i.style.left=a+"px",i.style.top=s+"px",i.style.width="60px",i.style.height="60px",i.style.border="2px solid #FE5F00",i.style.borderRadius="50%",i.style.transform="translate(-50%, -50%)",i.style.pointerEvents="none",i.style.animation="focusPulse 0.6s ease-out",i.style.zIndex="150",document.getElementById("camera-container").appendChild(i),setTimeout(()=>{i.remove()},600)}})}function Q(){const e=document.getElementById("unified-menu");At(),kn(),xe(),M=!0,N=!0,e.style.display="flex"}function Oe(){M=!1,N=!1,C=0,G="",document.getElementById("style-filter").value="",document.getElementById("unified-menu").style.display="none"}function kn(){const e=document.getElementById("current-resolution-display");if(e){const t=oe[F];e.textContent=`${t.width}x${t.height}`}}function xe(){const e=document.getElementById("current-burst-display");if(e){let t="Medium";for(const[n,a]of Object.entries(z))if(a.delay===re){t=a.label;break}e.textContent=`${p} photos, ${t}`}}function Tn(){document.getElementById("unified-menu").style.display="none";const e=document.getElementById("resolution-submenu"),t=document.getElementById("resolution-list");t.innerHTML="",oe.forEach((n,a)=>{const s=document.createElement("div");s.className="resolution-item",a===F&&s.classList.add("active");const i=document.createElement("span");i.className="resolution-name",i.textContent=n.name,s.appendChild(i),s.onclick=()=>{rn(a),Rt()},t.appendChild(s)}),e.style.display="flex"}function Rt(){document.getElementById("resolution-submenu").style.display="none",Q()}function In(){document.getElementById("unified-menu").style.display="none";const e=document.getElementById("burst-submenu"),t=document.getElementById("burst-count-slider"),n=document.getElementById("burst-speed-slider"),a=document.getElementById("burst-count-value"),s=document.getElementById("burst-speed-value");if(t&&a&&(t.value=p,a.textContent=p),n&&s){let i=2;for(const[o,r]of Object.entries(z))if(r.delay===re){i=parseInt(o);break}n.value=i,s.textContent=z[i].label}e.style.display="flex"}function wn(){document.getElementById("burst-submenu").style.display="none",Q()}function At(){const e=document.getElementById("menu-styles-list");e.innerHTML="";const t=document.createDocumentFragment(),{favorites:n,regular:a}=It(),s=a.filter(i=>{if(!G)return!0;const o=G.toLowerCase();return i.name.toLowerCase().includes(o)||i.message.toLowerCase().includes(o)});if(n.length>0&&!G){const i=document.createElement("h3");i.className="menu-section-header",i.textContent="★ Favorites",t.appendChild(i),n.forEach(o=>{const r=it(o);t.appendChild(r)})}if(s.length>0){const i=document.createElement("h3");i.className="menu-section-header",i.textContent=G?"Search Results":"All Styles",t.appendChild(i),s.forEach(o=>{const r=it(o);t.appendChild(r)})}if(s.length===0&&G){const i=document.createElement("div");i.className="menu-empty",i.textContent="No styles found",t.appendChild(i)}e.appendChild(t),ve()}function Ot(e="Add New Style"){const t=document.getElementById("style-editor");document.getElementById("editor-title").textContent=e,t.style.display="flex"}function Ne(){document.getElementById("style-editor").style.display="none",document.getElementById("style-name").value="",document.getElementById("style-message").value="",document.getElementById("delete-style").style.display="none",_=-1}function Sn(e){_=e;const t=l[e];document.getElementById("style-name").value=t.name,document.getElementById("style-message").value=t.message,document.getElementById("delete-style").style.display="block",Ot("Edit Style")}function Bn(){const e=document.getElementById("style-name").value.trim(),t=document.getElementById("style-message").value.trim();if(!e||!t){alert("Please fill in both name and AI prompt");return}_>=0?l[_]={name:e,message:t}:l.push({name:e,message:t}),Bt(),Ne(),Q()}function Cn(){_>=0&&l.length>1&&confirm("Delete this style?")&&(l.splice(_,1),g>=l.length&&(g=l.length-1),Bt(),Ne(),Q())}window.addEventListener("load",()=>{Xt(),vn(),bn();const e=document.getElementById("start-button");e&&e.addEventListener("click",hn);const t=document.getElementById("burst-toggle");t&&t.addEventListener("click",mn);const n=document.getElementById("random-toggle");n&&n.addEventListener("click",nn);const a=document.getElementById("menu-button");a&&a.addEventListener("click",Q);const s=document.getElementById("close-menu");s&&s.addEventListener("click",Oe);const i=document.getElementById("resolution-menu-button");i&&i.addEventListener("click",Tn);const o=document.getElementById("resolution-back");o&&o.addEventListener("click",Rt);const r=document.getElementById("burst-menu-button");r&&r.addEventListener("click",In);const b=document.getElementById("burst-back");b&&b.addEventListener("click",wn);const A=document.getElementById("style-filter");A&&A.addEventListener("input",k=>{G=k.target.value,At()});const de=document.getElementById("add-style-menu");de&&de.addEventListener("click",()=>{_=-1,Ot("Add New Style")});const Z=document.getElementById("burst-count-slider"),$=document.getElementById("burst-speed-slider");Z&&Z.addEventListener("input",k=>{p=parseInt(k.target.value),document.getElementById("burst-count-value").textContent=p;const ee=parseInt($.value);ot(p,ee),xe(),U&&(d.textContent=`Burst mode ON (${p} photos) • ${l[g].name}`)}),$&&$.addEventListener("input",k=>{const ee=parseInt(k.target.value);re=z[ee].delay,document.getElementById("burst-speed-value").textContent=z[ee].label,ot(p,ee),xe()}),dn();const D=document.getElementById("reset-button");D&&D.addEventListener("click",Pt);const H=document.getElementById("camera-button");H&&H.addEventListener("click",cn);const me=document.getElementById("close-editor");me&&me.addEventListener("click",Ne);const ue=document.getElementById("save-style");ue&&ue.addEventListener("click",Bn);const De=document.getElementById("delete-style");De&&De.addEventListener("click",Cn),j=document.getElementById("connection-status"),W=document.getElementById("queue-status"),L=document.getElementById("sync-button"),L&&L.addEventListener("click",ie),W&&W.addEventListener("click",Ae);const He=document.getElementById("close-queue-manager");He&&He.addEventListener("click",fn);const je=document.getElementById("sync-all");je&&je.addEventListener("click",ie);const Ge=document.getElementById("clear-queue");Ge&&Ge.addEventListener("click",Lt);const Ue=document.getElementById("gallery-button");Ue&&Ue.addEventListener("click",K);const Fe=document.getElementById("close-gallery");Fe&&Fe.addEventListener("click",bt);const qe=document.getElementById("close-viewer");qe&&qe.addEventListener("click",qt);const _e=document.getElementById("delete-viewer-image");_e&&_e.addEventListener("click",_t);const $e=document.getElementById("gallery-start-date-btn"),ke=document.getElementById("gallery-start-date");$e&&ke&&($e.addEventListener("click",()=>{ke.showPicker()}),ke.addEventListener("change",k=>{ae=k.target.value||null,at("start",ae),Be()}));const Ye=document.getElementById("gallery-end-date-btn"),Te=document.getElementById("gallery-end-date");Ye&&Te&&(Ye.addEventListener("click",()=>{Te.showPicker()}),Te.addEventListener("change",k=>{se=k.target.value||null,at("end",se),Be()}));const Ve=document.getElementById("gallery-sort-order");Ve&&Ve.addEventListener("change",k=>{ut=k.target.value,Be()});const We=document.getElementById("prev-page");We&&We.addEventListener("click",Ut);const ze=document.getElementById("next-page");ze&&ze.addEventListener("click",Gt);const Je=document.getElementById("load-preset-button");Je&&Je.addEventListener("click",$t);const Ke=document.getElementById("close-preset-selector");Ke&&Ke.addEventListener("click",kt);const Xe=document.getElementById("preset-filter");Xe&&Xe.addEventListener("input",k=>{pe=k.target.value,Tt()});const Qe=document.getElementById("magic-button");Qe&&Qe.addEventListener("click",Vt),Dt(),Wt()});window.removeFromQueue=yn;window.previewQueueItem=En;window.clearQueue=Lt;console.log("AI Camera Styles app initialized!");
